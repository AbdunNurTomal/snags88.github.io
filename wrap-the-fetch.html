<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title>Wrap the Fetch</title> <meta name="description" content="Alright, here’s my promised post about the first library I published onnpm. If you missed my post about how to publish a library to npm, checkout the previou..."> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="http://snags88.github.io/wrap-the-fetch"> <link rel="alternate" type="application/rss+xml" title="gem install Seiji" href="http://snags88.github.io/feed.xml"> <script src="/assets/js/modernizr.js"></script> </head> <body"> <main class="wrapper"> <header class="site-header"> <a href="#navbar" id="menu-burger" class="menu-burger">Menu <span class="nav-icon"></span> <svg x="0px" y="0px" width="54px" height="54px" viewBox="0 0 54 54"> <circle fill="transparent" stroke="#000000" stroke-width="1" cx="27" cy="27" r="25" stroke-dasharray="157 157" stroke-dashoffset="157"></circle> </svg> </a> <div id="navbar" class="navbar"> <div class="navigation-wrapper"> <div class="half-block"> <h2>Navigation</h2> <nav> <ul class="no-style primary-nav"> <li><a href="/">Home</a></li> <li><a href="/blog">Blog</a></li> <li><a href="/about">About</a></li> <li><a href="http://github.com/snags88" target="_blank"><i class="icon icon-github"></i> Github</a></li> <li><a href="http://linkedin.com/in/snaganuma" target="_blank"><i class="icon icon-linkedin"></i> LinkedIn</a></li> <li><a href="http://twitter.com/S2k10" target="_blank"><i class="icon icon-twitter"></i> Twitter</a></li> </ul> </nav> </div> </div> </div> </header> <article class="post" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header intro"> <div class="intro-in"> <h1 class="post-title" itemprop="name headline">Wrap the Fetch</h1> <p class="post-meta"><time datetime="2016-11-23T04:30:00-08:00" itemprop="datePublished">Nov 23, 2016</time></p> </div> </header> <div class="post-content container" itemprop="articleBody"> <p>Alright, here’s my promised post about the first library I published on npm. If you missed my post about how to publish a library to npm, check out the <a href="/creating-an-npm-library-with-webpack">previous post here</a>.</p> <h2 id="origin-of-wtfetch">Origin of <code class="highlighter-rouge">wtfetch</code></h2> <p>The library I published is called <code class="highlighter-rouge">wtfetch</code> short for “wrap the fetch”. Yeah I gotta work on my name creativity, but Mean Girls references were mostly taken along with Farfetch references…</p> <p>Anyway, the library is a wrapper I created for the (somewhat) new Javascript <code class="highlighter-rouge">fetch</code> API for <a href="https://learn.co">Learn.co</a>. In our codebase, we were using jQuery’s <code class="highlighter-rouge">$.ajax()</code> function to make API calls from our Alt sources (an implementation of Flux), which seemed pretty unnecessary since we were requiring an entire library to make our AJAX request.</p> <p>Upon further research, there are libraries that are solely creating for making HTTP request from the client (<a href="https://github.com/mzabriskie/axios"><code class="highlighter-rouge">axios</code></a>, <a href="https://github.com/visionmedia/superagent"><code class="highlighter-rouge">superagent</code></a> to name a few). However, all of these libraries are just convenience wrappers around the underlying Javascript <code class="highlighter-rouge">XMLHttpRequest</code> API.</p> <p>My research eventually led me to the new Javascript <code class="highlighter-rouge">fetch</code> API that have been implemented in newer web browsers (see <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API#Browser_compatibility">this chart</a> for compatible browsers) and of course the brilliant people at Github created a polyfill that would make this functionality available on unsupported browsers.</p> <p>The usage and understandability of <code class="highlighter-rouge">fetch</code> is a million times easier than <code class="highlighter-rouge">XMLHttpRequest</code> and <a href="https://developers.google.com/web/updates/2015/03/introduction-to-fetch">this post</a> does a great job of explaining the differences in the usage of the two APIs.</p> <h2 id="about-wtfetch">About <code class="highlighter-rouge">wtfetch</code></h2> <p>The <code class="highlighter-rouge">fetch</code> API was so easy to understand that I was able to create a wrapper for it and publish it to npm as a library called <code class="highlighter-rouge">wtfetch</code>. This library does a few things for the developer:</p> <ol> <li>It exposes a API for specific HTTP request type: <code class="highlighter-rouge">get</code>, <code class="highlighter-rouge">post</code>, <code class="highlighter-rouge">patch</code>, <code class="highlighter-rouge">deleteRequest</code> (<code class="highlighter-rouge">delete</code> is a keyword in Javascript so I wanted to avoid the name conflict)</li> <li>It sets the default header to request/send JSON. These headers can be overridden by the developer.</li> <li>The HTTP request will return a Promise.</li> <li>It automatically <code class="highlighter-rouge">throw</code>s an error if the request was unsuccessful. I think that this is something that should automatically be handled in <code class="highlighter-rouge">fetch</code> but it’s not.</li> <li>On successful responses, it returns the parsed response body in the promise chain.</li> <li>On <code class="highlighter-rouge">get</code> requests, it automatically encodes data as the query string before making the request.</li> </ol> <p>The only dependency of the library is the <code class="highlighter-rouge">whatwg-fetch</code> polyfill. Lastly, <code class="highlighter-rouge">wtfetch</code> is fully tested using Mocha + Chai (woooo!).</p> <h2 id="example-usage">Example Usage</h2> <p>To use the library, here is an example of making a <code class="highlighter-rouge">get</code> request with query strings:</p> <figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="c1">// Import or require functions from library</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">get</span><span class="p">,</span> <span class="nx">post</span><span class="p">,</span> <span class="nx">patch</span><span class="p">,</span> <span class="nx">deleteRequest</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'wtfetch'</span>

<span class="c1">// Use the function to make HTTP request</span>
<span class="nx">get</span><span class="p">(</span><span class="s1">'www.google.com'</span><span class="p">,</span> <span class="p">{</span> <span class="na">data</span><span class="p">:</span> <span class="p">{</span><span class="na">q</span><span class="p">:</span> <span class="s1">'search term'</span><span class="p">}})</span></code></pre></figure> <p>More examples can be found on the README of the repo <a href="https://github.com/snags88/wtfetch">here</a>.</p> <h2 id="conclusion">Conclusion</h2> <p>I think this was a good first library since I didn’t try to oversolve an existing problem. I liked that it got me introduced to publishing to npm. I also liked that it got me thinking about some good practices to follow like tagging release commits on git and writing more JS specs. I feel like there’s a few more libraries I can pull out of our codebase, so be on the look out for those. But for now, <a href="https://www.npmjs.com/package/wtfetch">here is the library on npm</a>.</p> </div> </article> <footer class="site-footer"> <div class="container"> <ul class="social"> <li><a href="http://github.com/snags88" target="_blank"><i class="icon icon-github"></i></a></li> <li><a href="http://linkedin.com/in/snaganuma" target="_blank"><i class="icon icon-linkedin"></i></a></li> <li><a href="http://twitter.com/S2k10" target="_blank"><i class="icon icon-twitter"></i></a></li> </ul> <p> <small>&copy;2018 All rights reserved. Powered by <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> with <a href="https://github.com/nandomoreirame/dotX" target="_blank">dotX</a> theme.</small> </p> </div> </footer> </main> <script src="/assets/js/jquery-2.1.1.js"></script> <script src="/assets/js/main.js"></script> </body> </html>