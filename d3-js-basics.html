<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title>D3.js Basics</title> <meta name="description" content="D3.js is something I’ve been meaning to pick up and learn for a while. In my long flight and train rides, I’ve had time to go through and play around with so..."> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="http://snags88.github.io/d3-js-basics"> <link rel="alternate" type="application/rss+xml" title="gem install Seiji" href="http://snags88.github.io/feed.xml"> <script src="/assets/js/modernizr.js"></script> </head> <body"> <main class="wrapper"> <header class="site-header"> <a href="#navbar" id="menu-burger" class="menu-burger">Menu <span class="nav-icon"></span> <svg x="0px" y="0px" width="54px" height="54px" viewBox="0 0 54 54"> <circle fill="transparent" stroke="#000000" stroke-width="1" cx="27" cy="27" r="25" stroke-dasharray="157 157" stroke-dashoffset="157"></circle> </svg> </a> <div id="navbar" class="navbar"> <div class="navigation-wrapper"> <div class="half-block"> <h2>Navigation</h2> <nav> <ul class="no-style primary-nav"> <li><a href="/">Home</a></li> <li><a href="/blog">Blog</a></li> <li><a href="/about">About</a></li> <li><a href="http://github.com/snags88" target="_blank"><i class="icon icon-github"></i> Github</a></li> <li><a href="http://linkedin.com/in/snaganuma" target="_blank"><i class="icon icon-linkedin"></i> LinkedIn</a></li> <li><a href="http://twitter.com/S2k10" target="_blank"><i class="icon icon-twitter"></i> Twitter</a></li> </ul> </nav> </div> </div> </div> </header> <article class="post" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header intro"> <div class="intro-in"> <h1 class="post-title" itemprop="name headline">D3.js Basics</h1> <p class="post-meta"><time datetime="2015-05-06T20:17:00-07:00" itemprop="datePublished">May 6, 2015</time></p> </div> </header> <div class="post-content container" itemprop="articleBody"> <p>D3.js is something I’ve been meaning to pick up and learn for a while. In my long flight and train rides, I’ve had time to go through and play around with some of its powerful features. In this blog post, I’ll just cover the very basic concepts of D3; selectors, modification of DOM elements, and data joins.</p> <h3 id="selectors">Selectors</h3> <p>If you’ve used jQuery before, this is really straight forward. D3 allows you to select DOM elements using the <strong>select</strong> or <strong>selectAll</strong> functions. The difference being that the first function selects the first matching element whereas the second function will select all matching elements.</p> <figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s2">"div"</span><span class="p">);</span>
<span class="c1">//=&gt; selects the first div element in the document and returns a sudo-array object</span>
<span class="nx">d3</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s2">"div"</span><span class="p">);</span>
<span class="c1">//=&gt; selects all div elements in the document and returns a sudo-array object</span></code></pre></figure> <h3 id="modifying-the-dom">Modifying the DOM</h3> <p>Also similar to jQuery, D3 allows you to modify DOM elements that have been selected. Some of the more common functions used to change the DOM is shown in the following example.</p> <figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">//=&gt; first, select one or more elements and store to variable</span>
<span class="kd">var</span> <span class="nx">divs</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s2">"div"</span><span class="p">);</span>

<span class="c1">//=&gt; next, call the modifier functions on the selection</span>
<span class="nx">divs</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">"hello"</span><span class="p">,</span> <span class="s2">"world"</span><span class="p">)</span> <span class="c1">//attr will set the div's "hello" attribute value to "world"</span>
<span class="nx">divs</span><span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="s2">"background-color"</span><span class="p">,</span> <span class="s2">"blue"</span><span class="p">)</span> <span class="c1">//style changes the css property of the elements</span>
<span class="nx">divs</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="s2">"foo bar!"</span><span class="p">)</span> <span class="c1">//text will replace the text content of the elements</span>
<span class="nx">divs</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">"div"</span><span class="p">)</span> <span class="c1">//append will append a new element of the given name to the end of the selection</span>
<span class="nx">divs</span><span class="p">.</span><span class="nx">remove</span><span class="p">()</span> <span class="c1">//remove will remove the selected elements from the DOM</span></code></pre></figure> <h3 id="data-joins">Data Joins</h3> <p>Here’s where the real fun begins. D3 allows you to bind data to DOM elements and use it as you need. The data can be bound using the <strong>data</strong> function and providing it an array of data. For example, let’s say that you have 3 div elements on your page. You can select all the divs using the selector and bind different data to each element like this:</p> <figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">divs</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s2">"div"</span><span class="p">);</span>
<span class="nx">divs</span><span class="p">.</span><span class="nx">data</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span> <span class="c1">//data will bind each element of the provided array to the selected DOM elements</span></code></pre></figure> <p>After the data is bound, it can be used as a basis for modifying the elements. This really comes in handy because D3.js is a data visualization tool so you can start to format things based on the data bound to the element. As an example, let’s use the <strong>style</strong> function from before to drive the styling of the elements from the data.</p> <figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">divs</span><span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="s2">"width"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="p">(</span><span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="nx">d</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="s2">"px"</span><span class="p">})</span>
    <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="s2">"height"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="p">(</span><span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="nx">d</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="s2">"px"</span><span class="p">})</span>
    <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="s2">"background-color"</span><span class="p">,</span> <span class="s2">"black"</span><span class="p">);</span></code></pre></figure> <p>In the first two lines, we specify that the <strong>width</strong> and <strong>height</strong> property be set to the return value of the function. The function automatically gets 2 arguments: the data value of the element and the index value of the element in the selected array.  The function uses those two arguments to calculate the width and length of the divs. The styles get applied to all three div elements so you can think of it as doing a loop through the array of divs.</p> <p>Another powerful feature of data joins is that you can add or remove multiple elements based on the data join of the elements. Let’s say for example, that instead of 3 data points in the previous example, we have 10. Then we can simply pass in the data array to the <strong>data</strong> function and add those to the DOM.</p> <figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">divs</span><span class="p">.</span><span class="nx">data</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
    <span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">"div"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="s2">"width"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="p">(</span><span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="nx">d</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="s2">"px"</span><span class="p">})</span>
    <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="s2">"height"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="p">(</span><span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="nx">d</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="s2">"px"</span><span class="p">})</span>
    <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="s2">"background-color"</span><span class="p">,</span> <span class="s2">"black"</span><span class="p">)</span></code></pre></figure> <p>An important note is that the <strong>enter</strong> function is used. This function will only apply the proceeding method chain to new elements that are going to enter the DOM. In this case, the first 3 elements were already in the DOM so they will not be effected. However, the <strong>enter</strong> function will return the entering elements and they will be appended to the DOM with the specified styles.</p> <p>On the other hand, if we wanted to remove elements from the DOM, we would apply the opposite function called <strong>exit</strong> and then <strong>remove</strong> those elements that are yielded from the <strong>exit</strong> function.</p> <figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">d3</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s2">"div"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">data</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span>
    <span class="p">.</span><span class="nx">exit</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">remove</span><span class="p">()</span></code></pre></figure> <p>Once you get the hang of manipulating elements, you can add animations to them using <strong>transition</strong> and <strong>duration</strong> to make some cool stuff. Oh and I forgot to mention that you can use these exact same functions to modify SVG elements. Combining everything together will look something like this:</p> <figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s2">"body"</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">"svg"</span><span class="p">)</span>
              <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">"width"</span><span class="p">,</span> <span class="mi">720</span><span class="p">)</span>
              <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">"height"</span><span class="p">,</span> <span class="mi">720</span><span class="p">)</span>

<span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s2">"circle"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">data</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>
    <span class="p">.</span><span class="nx">enter</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">"circle"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">"cx"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span><span class="k">return</span> <span class="nx">d</span> <span class="o">*</span> <span class="mi">5</span><span class="p">})</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">"cy"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">){</span><span class="k">return</span> <span class="nx">d</span> <span class="o">*</span> <span class="mi">5</span><span class="p">})</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">"r"</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="kd">var</span> <span class="nx">circles</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s2">"circle"</span><span class="p">)</span>

<span class="nx">circles</span><span class="p">.</span><span class="nx">transition</span><span class="p">()</span>
     <span class="p">.</span><span class="nx">duration</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
     <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">"cx"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">200</span><span class="p">})</span>
     <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">"cy"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">200</span><span class="p">})</span>
     <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">"r"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">50</span><span class="p">})</span></code></pre></figure> <p>Whew, that about wraps up the basic D3.js functions. There’s way more you can do with D3, but that’s it for now. Until next time, happy coding!</p> </div> </article> <footer class="site-footer"> <div class="container"> <ul class="social"> <li><a href="http://github.com/snags88" target="_blank"><i class="icon icon-github"></i></a></li> <li><a href="http://linkedin.com/in/snaganuma" target="_blank"><i class="icon icon-linkedin"></i></a></li> <li><a href="http://twitter.com/S2k10" target="_blank"><i class="icon icon-twitter"></i></a></li> </ul> <p> <small>&copy;2018 All rights reserved. Powered by <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> with <a href="https://github.com/nandomoreirame/dotX" target="_blank">dotX</a> theme.</small> </p> </div> </footer> </main> <script src="/assets/js/jquery-2.1.1.js"></script> <script src="/assets/js/main.js"></script> </body> </html>